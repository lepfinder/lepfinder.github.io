<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="../../../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="../../../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="../../../../css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="servlet," />








  <link rel="shortcut icon" type="image/x-icon" href="../../../../favicon.ico?v=5.1.2" />






<meta name="description" content="概述1. 什么是servlet Servlet 是基于 Java 技术的 web 组件，容器托管的，用于生成动态内容。可以被基于 Java 技术的 web server 动态加载并运行。客户端 通过 Servlet 容器实现的请求/应答模型与 Servlet 交互。  servlet 发展历史 123456789101112131415161718192021+=============+====">
<meta name="keywords" content="servlet">
<meta property="og:type" content="article">
<meta property="og:title" content="深入解析 servlet">
<meta property="og:url" content="http://yoursite.com/2017/09/21/javaweb-编程-深入理解-servlet/index.html">
<meta property="og:site_name" content="XiYang&#39;s Blog">
<meta property="og:description" content="概述1. 什么是servlet Servlet 是基于 Java 技术的 web 组件，容器托管的，用于生成动态内容。可以被基于 Java 技术的 web server 动态加载并运行。客户端 通过 Servlet 容器实现的请求/应答模型与 Servlet 交互。  servlet 发展历史 123456789101112131415161718192021+=============+====">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505977781169.png?imageMogr2/thumbnail/!100p/quality/100!">
<meta property="og:image" content="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505981204960.png?imageMogr2/thumbnail/!100p/quality/100!">
<meta property="og:image" content="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505981362268.png?imageMogr2/thumbnail/!100p/quality/100!">
<meta property="og:image" content="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505981925324.png?imageMogr2/thumbnail/!100p/quality/100!">
<meta property="og:updated_time" content="2017-09-27T04:00:57.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="深入解析 servlet">
<meta name="twitter:description" content="概述1. 什么是servlet Servlet 是基于 Java 技术的 web 组件，容器托管的，用于生成动态内容。可以被基于 Java 技术的 web server 动态加载并运行。客户端 通过 Servlet 容器实现的请求/应答模型与 Servlet 交互。  servlet 发展历史 123456789101112131415161718192021+=============+====">
<meta name="twitter:image" content="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505977781169.png?imageMogr2/thumbnail/!100p/quality/100!">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/09/21/javaweb-编程-深入理解-servlet/"/>





  <title>深入解析 servlet | XiYang's Blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?bffcaa4817f1c175af0805eb96d7e7ba";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">XiYang's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">让一切慢下来，体验周边的美好</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-project">
          <a href="/project/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-life-ring"></i> <br />
            
            个人项目
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="XiYang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="../../../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiYang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">深入解析 servlet</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-21T00:00:00+08:00">
                2017-09-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="../../../../categories/javaweb/" itemprop="url" rel="index">
                    <span itemprop="name">javaweb</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/21/javaweb-编程-深入理解-servlet/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><h3 id="1-什么是servlet"><a href="#1-什么是servlet" class="headerlink" title="1. 什么是servlet"></a>1. 什么是servlet</h3><blockquote>
<p>Servlet 是基于 Java 技术的 web 组件，容器托管的，用于生成动态内容。<br>可以被基于 Java 技术的 web server 动态加载并运行。<br>客户端 通过 Servlet 容器实现的请求/应答模型与 Servlet 交互。</p>
</blockquote>
<p>servlet 发展历史</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">+=============+================+====================+=============================================================================+</div><div class="line">|   VERSION   |      DATE      |   JAVA EE / JDK    |                             FEATURES / CHANGES                              |</div><div class="line">+=============+================+====================+=============================================================================+</div><div class="line">| Servlet 3.1 | May 2013       | JavaEE 7           | Non-blocking I/O, HTTP protocol upgrade mechanism                           |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 3.0 | December 2009  | JavaEE 6, JavaSE 6 | Pluggability, Ease of development, Async Servlet, Security, File Uploading  |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 2.5 | September 2005 | JavaEE 5, JavaSE 5 | Requires JavaSE 5, supports annotation                                      |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 2.4 | November 2003  | J2EE 1.4, J2SE 1.3 | web.xml uses XML Schema                                                     |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 2.3 | August 2001    | J2EE 1.3, J2SE 1.2 | Addition of Filter                                                          |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 2.2 | August 1999    | J2EE 1.2, J2SE 1.2 | Becomes part of J2EE, introduced independent web applications in .war files |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 2.1 | November 1998  | Unspecified        | First official specification, added RequestDispatcher, ServletContext       |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 2.0 |                | JDK 1.1            | Part of Java Servlet Development Kit 2.0                                    |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div><div class="line">| Servlet 1.0 | June 1997      |                    |                                                                             |</div><div class="line">+-------------+----------------+--------------------+-----------------------------------------------------------------------------+</div></pre></td></tr></table></figure>
<h3 id="2-什么是servlet容器"><a href="#2-什么是servlet容器" class="headerlink" title="2. 什么是servlet容器"></a>2. 什么是servlet容器</h3><blockquote>
<p>Servlet 容器是 Web 服务器或应用程序服务器的一部分，用来提供发送 请求和响应 的网络服务，解码基于 MIME 的请求，并格式化基于 MIMIE 的响应。它包含和管理 servlets 的生命周期。</p>
</blockquote>
<h2 id="servlet-接口"><a href="#servlet-接口" class="headerlink" title="servlet 接口"></a>servlet 接口</h2><p>Servlet 接口是 Java Servlet API 的核心抽象。所有 Servlet 类必须直接或间接的实现该接口，或者更通常做法 是通过继承一个实现了该接口的类从而复用许多共性功能。目前有 GenericServlet 和 HttpServlet 这两个类实 现了 Servlet 接口。大多数情况下，开发者只需要继承 HttpServlet 去实现自己的 Servlet 即可。</p>
<p>servlet 相关的类图如下：</p>
<p><img src="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505977781169.png?imageMogr2/thumbnail/!100p/quality/100!" alt=""></p>
<p>Servlet 接口定义如下：（servlet 版本号 3.1.0）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> javax.servlet;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Defines methods that all servlets must implement.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * &lt;p&gt;A servlet is a small Java program that runs within a Web server.</span></div><div class="line"><span class="comment"> * Servlets receive and respond to requests from Web clients,</span></div><div class="line"><span class="comment"> * usually across HTTP, the HyperText Transfer Protocol. </span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * &lt;p&gt;To implement this interface, you can write a generic servlet</span></div><div class="line"><span class="comment"> * that extends</span></div><div class="line"><span class="comment"> * &lt;code&gt;javax.servlet.GenericServlet&lt;/code&gt; or an HTTP servlet that</span></div><div class="line"><span class="comment"> * extends &lt;code&gt;javax.servlet.http.HttpServlet&lt;/code&gt;.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Servlet</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * Called by the servlet container to indicate to a servlet that the </span></div><div class="line"><span class="comment">     * servlet is being placed into service.</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * &lt;p&gt;The servlet container calls the &lt;code&gt;init&lt;/code&gt;</span></div><div class="line"><span class="comment">     * method exactly once after instantiating the servlet.</span></div><div class="line"><span class="comment">     * The &lt;code&gt;init&lt;/code&gt; method must complete successfully</span></div><div class="line"><span class="comment">     * before the servlet can receive any requests.</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     */</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException</span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span></span>;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * Called by the servlet container to allow the servlet to respond to </span></div><div class="line"><span class="comment">     * a request.</span></div><div class="line"><span class="comment">     * &lt;p&gt;This method is only called after the servlet's &lt;code&gt;init()&lt;/code&gt;</span></div><div class="line"><span class="comment">     * method has completed successfully.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span></div><div class="line"><span class="function">	<span class="keyword">throws</span> ServletException, IOException</span>;</div><div class="line">	</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span></span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-1-请求处理方法"><a href="#2-1-请求处理方法" class="headerlink" title="2.1 请求处理方法"></a>2.1 请求处理方法</h3><p>Servlet 基础接口定义了用于客户端请求处理的 service 方法。当有请求到达时，该方法由 servlet 容器路由到一个 servlet 实例。<br>Web 应用程序的并发请求处理通常需要 Web 开发人员去设计适合多线程执行的 Servlet，从而保证 service 方法能在一个特定时间点处理多线程并发执行。(注:即 Servlet 默认是线程不安全的，需要开发人员处理 多线程问题)<br>通常 Web 容器对于并发请求将使用同一个 servlet 处理，并且在不同的线程中并发执行 service 方法。</p>
<h3 id="2-2-Servlet-生命周期"><a href="#2-2-Servlet-生命周期" class="headerlink" title="2.2 Servlet 生命周期"></a>2.2 Servlet 生命周期</h3><p>Servlet 是按照一个严格定义的生命周期被管理，该生命周期规定了 Servlet 如何被加载、实例化、初始化、 处理客户端请求，以及何时结束服务。该声明周期可以通过 javax.servlet.Servlet 接口中的 init、service 和 destroy 这些 API 来表示，所有 Servlet 必须直接或间接的实现 GenericServlet 或 HttpServlet 抽象类。</p>
<p>servlet的生命周期有四个阶段： 加载并实例化、初始化、请求处理、销毁。涉及到的方法有：init、service、destory等</p>
<h4 id="加载并实例化"><a href="#加载并实例化" class="headerlink" title="加载并实例化"></a>加载并实例化</h4><p>Servlet容器负责加载和实例化Servelt。当Servlet容器启动时，或者在容器检测到需要这个Servlet来响应第一个请求时，创建Servlet实例。当Servlet容器启动后，Servlet通过类加载器来加载Servlet类，加载完成后再new一个Servlet对象来完成实例化。</p>
<h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><p>在Servlet实例化之后，容器将调用init（）方法，并传递实现ServletConfig接口的对象。在init（）方法中，Servlet可以部署描述符中读取配置参数，或者执行任何其他一次性活动。在Servlet的整个生命周期类，init（）方法只被调用一次。</p>
<h4 id="请求处理"><a href="#请求处理" class="headerlink" title="请求处理"></a>请求处理</h4><p>当Servlet初始化后，容器就可以准备处理客户机请求了。当容器收到对这一Servlet的请求，就调用Servlet的service（）方法，并把请求和响应对象作为参数传递。当并行的请求到来时，多个service（）方法能够同时运行在独立的线程中。service()方法检查 HTTP 请求类型（GET、POST、PUT、DELETE 等），并在适当的时候调用 doGet()、doPost()、doPut()，doDelete() 等方法。</p>
<p>如下是HttpServlet里面service的实现：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></div><div class="line"><span class="function">	<span class="keyword">throws</span> ServletException, IOException</span>&#123;</div><div class="line">	String method = req.getMethod();</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (method.equals(METHOD_GET)) &#123;</div><div class="line">	    <span class="keyword">long</span> lastModified = getLastModified(req);</div><div class="line">	    <span class="keyword">if</span> (lastModified == -<span class="number">1</span>) &#123;</div><div class="line">		<span class="comment">// servlet doesn't support if-modified-since, no reason</span></div><div class="line">		<span class="comment">// to go through further expensive logic</span></div><div class="line">		doGet(req, resp);</div><div class="line">	    &#125; <span class="keyword">else</span> &#123;</div><div class="line">		<span class="keyword">long</span> ifModifiedSince = req.getDateHeader(HEADER_IFMODSINCE);</div><div class="line">		<span class="keyword">if</span> (ifModifiedSince &lt; lastModified) &#123;</div><div class="line">		    <span class="comment">// If the servlet mod time is later, call doGet()</span></div><div class="line">                    <span class="comment">// Round down to the nearest second for a proper compare</span></div><div class="line">                    <span class="comment">// A ifModifiedSince of -1 will always be less</span></div><div class="line">		    maybeSetLastModified(resp, lastModified);</div><div class="line">		    doGet(req, resp);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">		    resp.setStatus(HttpServletResponse.SC_NOT_MODIFIED);</div><div class="line">		&#125;</div><div class="line">	    &#125;</div><div class="line"></div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_HEAD)) &#123;</div><div class="line">	    <span class="keyword">long</span> lastModified = getLastModified(req);</div><div class="line">	    maybeSetLastModified(resp, lastModified);</div><div class="line">	    doHead(req, resp);</div><div class="line"></div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_POST)) &#123;</div><div class="line">	    doPost(req, resp);</div><div class="line">	    </div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_PUT)) &#123;</div><div class="line">	    doPut(req, resp);	</div><div class="line">	    </div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_DELETE)) &#123;</div><div class="line">	    doDelete(req, resp);</div><div class="line">	    </div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_OPTIONS)) &#123;</div><div class="line">	    doOptions(req,resp);</div><div class="line">	    </div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_TRACE)) &#123;</div><div class="line">	    doTrace(req,resp);</div><div class="line">	    </div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">	    <span class="comment">//</span></div><div class="line">	    <span class="comment">// Note that this means NO servlet supports whatever</span></div><div class="line">	    <span class="comment">// method was requested, anywhere on this server.</span></div><div class="line">	    <span class="comment">//</span></div><div class="line"></div><div class="line">	    String errMsg = lStrings.getString(<span class="string">"http.method_not_implemented"</span>);</div><div class="line">	    Object[] errArgs = <span class="keyword">new</span> Object[<span class="number">1</span>];</div><div class="line">	    errArgs[<span class="number">0</span>] = method;</div><div class="line">	    errMsg = MessageFormat.format(errMsg, errArgs);</div><div class="line">	    </div><div class="line">	    resp.sendError(HttpServletResponse.SC_NOT_IMPLEMENTED, errMsg);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="销毁"><a href="#销毁" class="headerlink" title="销毁"></a>销毁</h4><p>一旦Servlet容器检测到一个Servlet要被卸载，这可能是因为要回收资源或者因为它正在被关闭，容器会在所有Servlet的service（）线程之后，调用Servlet的destroy（）方法。然后，Servlet就可以进行无用存储单元收集清理。这样Servlet对象就被销毁了。这四个阶段共同决定了Servlet的生命周期。</p>
<h4 id="一个典型的处理过程"><a href="#一个典型的处理过程" class="headerlink" title="一个典型的处理过程"></a>一个典型的处理过程</h4><p>请看如下的时序图：</p>
<p><img src="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505981204960.png?imageMogr2/thumbnail/!100p/quality/100!" alt=""></p>
<p>请求的过程描述如下：</p>
<ul>
<li>Web Client 向Servlet容器（Tomcat）发出Http请求；</li>
<li>Servlet容器接收Web Client的请求；</li>
<li>Servlet容器创建一个HttpRequest对象，将Web Client请求的信息封装到这个对象中；</li>
<li>Servlet容器创建一个HttpResponse对象；</li>
<li>Servlet容器调用HttpServlet对象的service方法，把HttpRequest对象与HttpResponse对象作为参数传给 HttpServlet对象；</li>
<li>HttpServlet调用HttpRequest对象的有关方法，获取Http请求信息；</li>
<li>HttpServlet调用HttpResponse对象的有关方法，生成响应数据；</li>
<li>Servlet容器把HttpServlet的响应结果传给Web Client；</li>
</ul>
<p>Servlet的框架是由两个Java包组成的：javax.servlet与javax.servlet.http。在javax.servlet包中定义了所有的Servlet类都必须实现或者扩展的通用接口和类。在javax.servlet.http包中定义了采用Http协议通信的HttpServlet类。Servlet的框架的核心是javax.servlet.Servlet接口，所有的Servlet都必须实现这个接口。在Servlet接口中定义了5个方法，其中3个方法代表了Servlet的生命周期：</p>
<blockquote>
<p>init(ServletConfig)方法：负责初始化Servlet对象，在Servlet的生命周期中，该方法执行一次；该方法执行在单线程的环境下，因此开发者不用考虑线程安全的问题；<br>service(ServletRequest req,ServletResponse res)方法：负责响应客户的请求；为了提高效率，Servlet规范要求一个Servlet实例必须能够同时服务于多个客户端请求，即service()方法运行在多线程的环境下，Servlet开发者必须保证该方法的线程安全性；<br>destroy()方法：当Servlet对象退出生命周期时，负责释放占用的资源；</p>
</blockquote>
<p><img src="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505981362268.png?imageMogr2/thumbnail/!100p/quality/100!" alt=""></p>
<h2 id="Servlet-Context"><a href="#Servlet-Context" class="headerlink" title="Servlet Context"></a>Servlet Context</h2><p>ServletContext(Servlet 上下文)接口定义了 servlet 运行在的 Web 应用的视图。容器供应商负责提供 Servlet 容器的 ServletContext 接口的实现。Servlet 可以使用 ServletContext 对象记录事件，获取 URL 引用的资源， 存取当前上下文的其他 Servlet 可以访问的属性。<br>ServletContext 是 Web 服务器中已知路径的根。例如，Servlet 上下文可以从 <a href="http://www.mycorp.com/catalog" target="_blank" rel="external">http://www.mycorp.com/catalog</a> 找出，/catalog 请求路径称为上下文路径，所有以它开头的请求都会被路由到与 ServletContext 相关联的 Web 应用。</p>
<blockquote>
<p>Defines a set of methods that a servlet uses to communicate with its servlet container, for example, to get the MIME type of a file, dispatch requests, or write to a log file.<br>There is one context per “web application” per Java Virtual Machine. (A “web application” is a collection of servlets and content installed under a specific subset of the server’s URL namespace such as /catalog and possibly installed via a .war file.)</p>
</blockquote>
<h2 id="Servlet-中的-Listener"><a href="#Servlet-中的-Listener" class="headerlink" title="Servlet 中的 Listener"></a>Servlet 中的 Listener</h2><p>整个 Tomcat 服务器中 Listener 使用的非常广泛，它是基于观察者模式设计的，Listener 的设计对开发 Servlet 应用程序提供了一种快捷的手段，能够方便的从另一个纵向维度控制程序和数据。目前 Servlet 中提供了 5 种两类事件的观察者接口，它们分别是：</p>
<ul>
<li>4 个 EventListeners 类型的<ul>
<li>ServletContextAttributeListener</li>
<li>ServletRequestAttributeListener</li>
<li>ServletRequestListener</li>
<li>HttpSessionAttributeListener</li>
</ul>
</li>
<li>2 个 LifecycleListeners 类型的<ul>
<li>ServletContextListener</li>
<li>HttpSessionListener</li>
</ul>
</li>
</ul>
<p>如下图所示：</p>
<p><img src="http://7xo9p3.com1.z0.glb.clouddn.com/markdown/1505981925324.png?imageMogr2/thumbnail/!100p/quality/100!" alt=""></p>
<p>它们基本上涵盖了整个 Servlet 生命周期中，你感兴趣的每种事件。这些 Listener 的实现类可以配置在 web.xml 中的 <listener> 标签中。当然也可以在应用程序中动态添加 Listener，需要注意的是 ServletContextListener 在容器启动之后就不能再添加新的，因为它所监听的事件已经不会再出现。掌握这些 Listener 的使用，能够让我们的程序设计的更加灵活。</listener></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>servlet 规范（3.1）可以去网上下载中英文文档</p>
<p>Java Servlet 3.1 规范笔记<br><a href="https://emacsist.github.io/emacsist/servlet/Java%20Servlet%203.1%20%E8%A7%84%E8%8C%83%E7%AC%94%E8%AE%B0.html#org7916fb9" target="_blank" rel="external">https://emacsist.github.io/emacsist/servlet/Java%20Servlet%203.1%20%E8%A7%84%E8%8C%83%E7%AC%94%E8%AE%B0.html#org7916fb9</a></p>
<p>Servlet 工作原理解析<br><a href="https://www.ibm.com/developerworks/cn/java/j-lo-servlet/" target="_blank" rel="external">https://www.ibm.com/developerworks/cn/java/j-lo-servlet/</a></p>
<p>servlet的本质是什么，它是如何工作的？<br><a href="https://www.zhihu.com/question/21416727" target="_blank" rel="external">https://www.zhihu.com/question/21416727</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="../../../../tags/servlet/" rel="tag"># servlet</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="../javaweb-编程-深入解析spring-MVC/" rel="next" title="深入解析springmvc">
                <i class="fa fa-chevron-left"></i> 深入解析springmvc
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="../../25/每周札记/" rel="prev" title="每周札记">
                每周札记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name">XiYang</p>
            <p class="site-description motion-element" itemprop="description"></p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="../../../../archives/">
            
                <span class="site-state-item-count">43</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="../../../../categories/index.html">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="../../../../tags/index.html">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-什么是servlet"><span class="nav-number">1.1.</span> <span class="nav-text">1. 什么是servlet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-什么是servlet容器"><span class="nav-number">1.2.</span> <span class="nav-text">2. 什么是servlet容器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#servlet-接口"><span class="nav-number">2.</span> <span class="nav-text">servlet 接口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-请求处理方法"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 请求处理方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Servlet-生命周期"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 Servlet 生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#加载并实例化"><span class="nav-number">2.2.1.</span> <span class="nav-text">加载并实例化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#初始化"><span class="nav-number">2.2.2.</span> <span class="nav-text">初始化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#请求处理"><span class="nav-number">2.2.3.</span> <span class="nav-text">请求处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#销毁"><span class="nav-number">2.2.4.</span> <span class="nav-text">销毁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一个典型的处理过程"><span class="nav-number">2.2.5.</span> <span class="nav-text">一个典型的处理过程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet-Context"><span class="nav-number">3.</span> <span class="nav-text">Servlet Context</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet-中的-Listener"><span class="nav-number">4.</span> <span class="nav-text">Servlet 中的 Listener</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">5.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XiYang</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="../../../../lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="../../../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="../../../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="../../../../lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="../../../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="../../../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="../../../../js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="../../../../js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="../../../../js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="../../../../js/src/schemes/pisces.js?v=5.1.2"></script>



  <script type="text/javascript" src="../../../../js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="../../../../js/src/post-details.js?v=5.1.2"></script>


  
  <script type="text/javascript" src="../../../../js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="../../../../js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="../../../../js/src/bootstrap.js?v=5.1.2"></script>



  


  

    
      <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com2017/09/21/javaweb-编程-深入理解-servlet/';
          this.page.identifier = '2017/09/21/javaweb-编程-深入理解-servlet/';
          this.page.title = '深入解析 servlet';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
